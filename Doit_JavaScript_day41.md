## DOM에서 노드 추가, 삭제하기

웹 문서에서 처음 화면에는 내용이 보이지 않다가 클릭이나 이벤트가 발생하면 내용이 나타나는 경우가 있다.

이러한 동작은 CSS의 display 속성을 사용해서 만들 수도 있지만 DOM 트리에 새로운 노드를 추가하는 방법도 있다.

이때 주의할 점은, 노드를 추가하면 단순히 요소 노드뿐 아니라 텍스트와 속성 노드도 함께 추가해야 한다는 것이다.

***
### 노드 리스트란

<br>

DOM에서 새로운 노드를 만들어 추가하거나 삭제하려면 노드 리스트(node list)를 사용해야 한다.

노드 리스트란 무엇일까?

DOM에 접근할 때 querySelectorAll() 메서드를 사용하면 노드를 한꺼번에 여러 개 가져올 수 있다.

이때 노드 정보를 여러 개 저장한 것이 노드 리스트이다.

배열과 비슷하게 동작한다.

다음 예제와 함께 노드 리스트를 더 살펴보자

[노드 리스트 살펴보기](./Doit_JavaScript_day41-1.html)

<img src='./img/javascript13.png'>


결괏값으로 NodeList(3) [li, li, li]라고 표시된다.

li 요소의 형태가 노드 리스트인 것을 알 수 있다.

이처럼 노드 리스트란 노드를 여러 개 저장한 데이터 형태를 말한다.

배열은 아니지만 배열과 아주 비슷한 형태인 것을 알 수 있다.

노드 리스트는 배열과 비슷해서 인덱스 번호로 특정 위치의 노드에 접근할 수 있다.

다음과 같이 입력하면 li 노드 리스트 중에서 두 번째 노드를 가져올 수 있다.

<img src='./img/javascript14.png'>

<br>

### 새로운 노드 추가 과정

DOM 트리를 구성하는 기본 원칙을 다시 한번 살펴보자

1) 모든 HTML 태그는 요소(element)노드이다.
2) HTML 태그에서 사용하는 텍스트 내용은 자식 노드인 텍스트(text) 노드이다.
3) HTML 태그에 있는 속성은 자식 노드인 속성(attribute) 노드이다.
4) 주석은 주석(comment) 노드이다.

이 원칙에 따라 어떠한 태그를 노드로 추가한다면 단순히 태그에 해당하는 요소 노드뿐만 아니라 텍스트 노드와 속성 노드도 추가해야 한다.

예를 들어 img 태그를 요소로 추가한다면 어떤 노드를 더 추가해야 할까?

img 태그의 요소 노드와 속성에 해당하는 src, alt의 노드도 추가된다.

이 밖에도 사용하는 속성에 따라 더 많은 노드가 추가된다.

어떠한 웹 문서의 DOM 트리에 새로운 노드를 추가하려면 그 문서에 새로운 소스 코드를 작성해야 한다.

그래서 새 노드를 추가할 때는 웹 문서에 어떤 소스를 추가할지 먼저 생각하고, 그에 따라 요소 노드나 텍스트, 속성 노드 등을 만들어야 한다.

***
### 텍스트 노드를 사용하는 새로운 요소 추가하기

<br>

여기에서는 '더 보기' 링크를 클릭하면 그 아래에 간단한 텍스트가 표시되는 스크립트 소스를 작성해 보자.

문서에서는 단순히 p태그 하나가 추가되어 보이지만 DOM에서는 여러 단계가 필요하다는 것을 알 수 있다.

다음 단계를 따라 새로운 요소를 추가하는 방법을 배우고, 마지막으로 전체 코드를 완성해 보자.

1) 요소 노드 만들기 = createElement() 메서드

    DOM에 새로운 요소를 추가할 때 가장 먼저 할 일은 요소 노드를 만드는 것이다.

    이때 사용하는 메서드는 createElement() 인데 괄호 안에 해당하는 요소 노드를 만들면 된다.

        - 기본형

        document.createElement(노드명)

    예를 들어 새로운 p 요소를 만든다면 다음과 같이 작성한다.

    [p 요소 노드 만들기](./Doit_JavaScript_day41-2.html)

    하지만 createElement() 메서드는 새로운 노드를 만들 뿐 아직 웹 문서에 새로운 노드를 추가한 것은 아니다.

    이제 p 태그의 내용에 해당하는 텍스트 노드도 만들어야 한다.

    p노드를 추가한 DOM 트리의 모습은 다음 그림과 같다.

    <img src='./img/JS20.jpg'>

<br>

2) 텍스트 노드 만들기 - createTextNode() 메서드

    새로운 요소 노드를 만들었다면 그 다음은 내용을 담는 텍스트 노드를 자식 노드로 만들어 연결해야 한다.

    텍스트 노드를 만드는 메서드는 createTextNode()이고 다음과 같은 형식으로 사용한다.

        - 기본형

        document.createTextNode(텍스트);

    새롭게 만든 p 요소에 들어갈 내용이 있는 텍스트 노드는 txtNode 변수로 저장한다.

    [p 요소의 텍스트 노드 만들기](./Doit_JavaScript_day41-3.html)

    그리고 이것을 DOM 트리에 추가하면 다음 그림과 같이 나타낼 수 있다.

    <img src='./img/JS21.jpg'>

<br>

3) 자식 노드 연결하기 - appendChild() 메서드

    지금까지 새로운 p 노드(newP)와 사용할 텍스트 노드(txtNode)를 만들었다.

    아직까지는 노드를 만든 상태이며 부모 노드와 자식 노드로 연결되지 않았다.

    appendChild() 메서드는 텍스트 노드나 속성 노드를 만든 후 요소 노드에 연결할 때 사용한다.

    이때 appendChild() 메서드를 사용해서 연결하는 노드는 자식 노드 중 맨 끝에 추가된다.

        - 기본형

        부모노드.appendChild(자식노드)

    다음은 텍스트 노드 txtNode를 요소 노드 newP의 자식 노드로 연결하고, 
    
    newP 노드를 다시 \<div id='info'>\</div>의 자식 노드로 연결한다.

    [텍스트 노드를 자식 노드로 연결하기](./Doit_JavaScript_day41-4.html)

    다음 그림의 DOM 트리를 보면 부모 노드와 자식 노드가 서로 연결되었다.

    <img src='./img/JS22.jpg'>

<br>

4) 전체 소스 코드 완성하기

    지금까지 요소를 생성하고 서로 연결하는 방법을 알아보았으니 전체 소스를 작성해 보자.

    다음 예제를 보면 '더 보기' 링크를 클릭하는 부분에 addP() 함수와 this.onclick='' 코드가 추가되었다.

    이것은 addP() 함수가 한 번만 실행되도록 하기 위한 것이다.

    만일 이 코드를 추가하지 않으면 링크를 클릭할 때마다 p요소가 계속 추가된다.

    [링크를 클릭하면 텍스트 표시하기](./Doit_JavaScript_day41-5.html)